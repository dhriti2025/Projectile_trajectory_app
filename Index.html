<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Projectile Simulator</title>

<style>
body { font-family: Arial; text-align:center; }
canvas { border:1px solid black; margin-top:10px; }
.control { margin:5px; }
input[type=number] { width:70px; }
</style>
</head>
<body>

<h2>Projectile Motion Simulator</h2>

<!-- Projectile 1 -->
<h3>Projectile 1</h3>
<div class="control">
v₀(1):
<input type="range" id="v01" min="5" max="150" value="40" step="1">
<input type="number" id="v01Box" value="40">
m/s
</div>

<div class="control">
θ(1):
<input type="range" id="theta1" min="0" max="90" value="45">
<input type="number" id="theta1Box" value="45">
°
</div>

<hr>

<!-- Projectile 2 -->
<h3>Projectile 2</h3>
<div class="control">
v₀(2):
<input type="range" id="v02" min="5" max="150" value="30">
<input type="number" id="v02Box" value="30">
m/s
</div>

<div class="control">
θ(2):
<input type="range" id="theta2" min="0" max="90" value="60">
<input type="number" id="theta2Box" value="60">
°
</div>

<hr>

<h3>Environment</h3>
<div class="control">
Air Resistance:
<input type="checkbox" id="dragToggle">
</div>

<div class="control">
Air Density (ρ):
<input type="range" id="rho" min="0" max="2" step="0.1" value="1.2">
<input type="number" id="rhoBox" value="1.2" step="0.1">
kg/m³
</div>

<canvas id="canvas" width="900" height="500"></canvas>

<div id="results" style="margin-top:15px; text-align:left; width:900px; margin:auto;">
<h3>Results</h3>

<div id="results1"></div>
<br>
<div id="results2"></div>

</div>


<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

const g = 9.81;
const mass = 1;
const Cd = 0.47;
const A = 0.01;
const dt = 0.02;

function sync(slider, box){
  slider.oninput = () => box.value = slider.value;
  box.oninput = () => slider.value = box.value;
}

sync(v01,v01Box);
sync(theta1,theta1Box);
sync(v02,v02Box);
sync(theta2,theta2Box);
sync(rho,rhoBox);

function computeTrajectory(v0,theta,rho,drag){

  let vx = v0*Math.cos(theta);
  let vy = v0*Math.sin(theta);
  let x=0,y=0;
  let t=0;

  let points=[];
  let maxHeight=0;
  let timeToMaxHeight=0;

  while(y>=0){
    points.push({x,y});

    if(y>maxHeight){
      maxHeight=y;
      timeToMaxHeight=t;
    }

    let v=Math.sqrt(vx*vx+vy*vy);
    let ax=0;
    let ay=-g;

    if(drag && v>0){
      let dragForce=0.5*rho*Cd*A*v*v;
      ax -= (dragForce/mass)*(vx/v);
      ay -= (dragForce/mass)*(vy/v);
    }

    vx+=ax*dt;
    vy+=ay*dt;
    x+=vx*dt;
    y+=vy*dt;
    t+=dt;
  }

  let range=x;
  let totalTime=t;

  // Find time to half range
  let halfRangeTime=0;
  for(let i=0;i<points.length;i++){
    if(points[i].x>=range/2){
      halfRangeTime=i*dt;
      break;
    }
  }

  return {
    points,
    range,
    maxHeight,
    totalTime,
    halfRangeTime,
    timeToMaxHeight
  };
}

function drawGrid(scale,maxX,maxY){
  ctx.strokeStyle="#ddd";
  ctx.lineWidth=1;

  for(let x=0;x<=maxX;x+=10){
    ctx.beginPath();
    ctx.moveTo(x*scale,0);
    ctx.lineTo(x*scale,canvas.height);
    ctx.stroke();
  }

  for(let y=0;y<=maxY;y+=10){
    ctx.beginPath();
    ctx.moveTo(0,canvas.height-y*scale);
    ctx.lineTo(canvas.width,canvas.height-y*scale);
    ctx.stroke();
  }

  ctx.strokeStyle="black";
  ctx.lineWidth=2;
  ctx.beginPath();
  ctx.moveTo(0,canvas.height);
  ctx.lineTo(canvas.width,canvas.height);
  ctx.moveTo(0,0);
  ctx.lineTo(0,canvas.height);
  ctx.stroke();

  ctx.fillStyle="black";
  ctx.font="12px Arial";

  for(let x=0;x<=maxX;x+=20){
    ctx.fillText(x, x*scale-5, canvas.height-5);
  }

  for(let y=0;y<=maxY;y+=20){
    ctx.fillText(y, 5, canvas.height-y*scale);
  }
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  let v0_1=parseFloat(v01.value);
  let t1=parseFloat(theta1.value)*Math.PI/180;
  let v0_2=parseFloat(v02.value);
  let t2=parseFloat(theta2.value)*Math.PI/180;
  let rhoVal=parseFloat(rho.value);
  let drag=dragToggle.checked;

	let traj1=computeTrajectory(v0_1,t1,rhoVal,drag);
	let traj2=computeTrajectory(v0_2,t2,rhoVal,drag);
  

  let maxX=Math.max(
    ...traj1.points.map(p=>p.x),
    ...traj2.points.map(p=>p.x)
  );

  let maxY=Math.max(
    ...traj1.points.map(p=>p.y),
    ...traj2.points.map(p=>p.y)
  );

  let scaleX=canvas.width/(maxX*1.1);
  let scaleY=canvas.height/(maxY*1.1);
  let scale=Math.min(scaleX,scaleY);

  drawGrid(scale,maxX,maxY);

  function plot(traj,color){
    ctx.strokeStyle=color;
    ctx.lineWidth=2;
    ctx.beginPath();
    traj.forEach((p,i)=>{
      let px=p.x*scale;
      let py=canvas.height-p.y*scale;
      if(i===0) ctx.moveTo(px,py);
      else ctx.lineTo(px,py);
    });
    ctx.stroke();
  }

  plot(traj1.points,"blue");
  plot(traj2.points,"red");
document.getElementById("results1").innerHTML =
"<b>Projectile 1 (Blue)</b><br>" +
"Range: " + traj1.range.toFixed(2) + " m<br>" +
"Maximum Height: " + traj1.maxHeight.toFixed(2) + " m<br>" +
"Total Time of Flight: " + traj1.totalTime.toFixed(2) + " s<br>" +
"Time to Half Range: " + traj1.halfRangeTime.toFixed(2) + " s<br>" +
"Time to Maximum Height: " + traj1.timeToMaxHeight.toFixed(2) + " s";

document.getElementById("results2").innerHTML =
"<b>Projectile 2 (Red)</b><br>" +
"Range: " + traj2.range.toFixed(2) + " m<br>" +
"Maximum Height: " + traj2.maxHeight.toFixed(2) + " m<br>" +
"Total Time of Flight: " + traj2.totalTime.toFixed(2) + " s<br>" +
"Time to Half Range: " + traj2.halfRangeTime.toFixed(2) + " s<br>" +
"Time to Maximum Height: " + traj2.timeToMaxHeight.toFixed(2) + " s";


  requestAnimationFrame(draw);
}

draw();
</script>

</body>
</html>
